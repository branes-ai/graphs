====================================================================================================
HIERARCHICAL MODULE TABLE: resnet50
====================================================================================================

[1/3] Tracing with PyTorch FX...
[2/3] Running graph partitioner...
[3/3] Formatting hierarchical table...

====================================================================================================
GRAPH PROFILE
====================================================================================================

| Module                         | #Parameters          | MACs         | FLOPs        | Memory       |
|:-------------------------------|:---------------------|:-------------|:-------------|:-------------|
| model                          | 25.557M              | 4.089G       | 8.249G       | 426.00MB     |
|  conv1                         | 9.408K               | 118.014M     | 236.028M     | 3.85MB       |
|  bn1                           | 128                  |              | 4.014M       | 6.42MB       |
|  relu                          |                      |              | 802.816K     | 6.42MB       |
|  maxpool                       |                      |              |              | 4.01MB       |
|  layer1                        | 215.808K             | 667.943M     | 1.362G       | 95.61MB      |
|   layer1.0                     | 75.008K              | 231.211M     | 473.661M     | 37.23MB      |
|    conv1                       | 4.096K               | 12.845M      | 25.690M      | 1.62MB       |
|    bn1                         | 128                  |              | 1.004M       | 1.61MB       |
|    relu                        |                      |              | 200.704K     | 1.61MB       |
|    conv2                       | 36.864K              | 115.606M     | 231.211M     | 1.75MB       |
|    bn2                         | 128                  |              | 1.004M       | 1.61MB       |
|    relu_1                      |                      |              | 200.704K     | 1.61MB       |
|    conv3                       | 16.384K              | 51.380M      | 102.760M     | 4.08MB       |
|    bn3                         | 512                  |              | 4.014M       | 6.43MB       |
|    downsample                  | 16.896K              | 51.380M      | 106.775M     | 10.51MB      |
|     downsample.0               | 16.384K              | 51.380M      | 102.760M     | 4.08MB       |
|     downsample.1               | 512                  |              | 4.014M       | 6.43MB       |
|    relu_2                      |                      |              | 802.816K     | 6.42MB       |
|   layer1.1                     | 70.400K              | 218.366M     | 443.957M     | 29.19MB      |
|    conv1                       | 16.384K              | 51.380M      | 102.760M     | 4.08MB       |
|    bn1                         | 128                  |              | 1.004M       | 1.61MB       |
|    relu                        |                      |              | 200.704K     | 1.61MB       |
|    conv2                       | 36.864K              | 115.606M     | 231.211M     | 1.75MB       |
|    bn2                         | 128                  |              | 1.004M       | 1.61MB       |
|    relu_1                      |                      |              | 200.704K     | 1.61MB       |
|    conv3                       | 16.384K              | 51.380M      | 102.760M     | 4.08MB       |
|    bn3                         | 512                  |              | 4.014M       | 6.43MB       |
|    relu_2                      |                      |              | 802.816K     | 6.42MB       |
|   layer1.2                     | 70.400K              | 218.366M     | 443.957M     | 29.19MB      |
|    conv1                       | 16.384K              | 51.380M      | 102.760M     | 4.08MB       |
|    bn1                         | 128                  |              | 1.004M       | 1.61MB       |
|    relu                        |                      |              | 200.704K     | 1.61MB       |
|    conv2                       | 36.864K              | 115.606M     | 231.211M     | 1.75MB       |
|    bn2                         | 128                  |              | 1.004M       | 1.61MB       |
|    relu_1                      |                      |              | 200.704K     | 1.61MB       |
|    conv3                       | 16.384K              | 51.380M      | 102.760M     | 4.08MB       |
|    bn3                         | 512                  |              | 4.014M       | 6.43MB       |
|    relu_2                      |                      |              | 802.816K     | 6.42MB       |
|  add                           |                      |              | 802.816K     | 9.63MB       |
|  add_1                         |                      |              | 802.816K     | 9.63MB       |
|  add_2                         |                      |              | 802.816K     | 9.63MB       |
|  layer2                        | 1.220M               | 1.028G       | 2.073G       | 79.57MB      |
|   layer2.0                     | 379.392K             | 372.507M     | 752.439M     | 32.84MB      |
|    conv1                       | 32.768K              | 102.760M     | 205.521M     | 4.95MB       |
|    bn1                         | 256                  |              | 2.007M       | 3.21MB       |
|    relu                        |                      |              | 401.408K     | 3.21MB       |
|    conv2                       | 147.456K             | 115.606M     | 231.211M     | 2.60MB       |
|    bn2                         | 256                  |              | 501.760K     | 804.86KB     |
|    relu_1                      |                      |              | 100.352K     | 802.82KB     |
|    conv3                       | 65.536K              | 51.380M      | 102.760M     | 2.27MB       |
|    bn3                         | 1.024K               |              | 2.007M       | 3.22MB       |
|    downsample                  | 132.096K             | 102.760M     | 207.528M     | 8.56MB       |
|     downsample.0               | 131.072K             | 102.760M     | 205.521M     | 5.34MB       |
|     downsample.1               | 1.024K               |              | 2.007M       | 3.22MB       |
|    relu_2                      |                      |              | 401.408K     | 3.21MB       |
|   layer2.1                     | 280.064K             | 218.366M     | 440.345M     | 15.58MB      |
|    conv1                       | 65.536K              | 51.380M      | 102.760M     | 2.27MB       |
|    bn1                         | 256                  |              | 501.760K     | 804.86KB     |
|    relu                        |                      |              | 100.352K     | 802.82KB     |
|    conv2                       | 147.456K             | 115.606M     | 231.211M     | 1.39MB       |
|    bn2                         | 256                  |              | 501.760K     | 804.86KB     |
|    relu_1                      |                      |              | 100.352K     | 802.82KB     |
|    conv3                       | 65.536K              | 51.380M      | 102.760M     | 2.27MB       |
|    bn3                         | 1.024K               |              | 2.007M       | 3.22MB       |
|    relu_2                      |                      |              | 401.408K     | 3.21MB       |
|   layer2.2                     | 280.064K             | 218.366M     | 440.345M     | 15.58MB      |
|    conv1                       | 65.536K              | 51.380M      | 102.760M     | 2.27MB       |
|    bn1                         | 256                  |              | 501.760K     | 804.86KB     |
|    relu                        |                      |              | 100.352K     | 802.82KB     |
|    conv2                       | 147.456K             | 115.606M     | 231.211M     | 1.39MB       |
|    bn2                         | 256                  |              | 501.760K     | 804.86KB     |
|    relu_1                      |                      |              | 100.352K     | 802.82KB     |
|    conv3                       | 65.536K              | 51.380M      | 102.760M     | 2.27MB       |
|    bn3                         | 1.024K               |              | 2.007M       | 3.22MB       |
|    relu_2                      |                      |              | 401.408K     | 3.21MB       |
|   layer2.3                     | 280.064K             | 218.366M     | 440.345M     | 15.58MB      |
|    conv1                       | 65.536K              | 51.380M      | 102.760M     | 2.27MB       |
|    bn1                         | 256                  |              | 501.760K     | 804.86KB     |
|    relu                        |                      |              | 100.352K     | 802.82KB     |
|    conv2                       | 147.456K             | 115.606M     | 231.211M     | 1.39MB       |
|    bn2                         | 256                  |              | 501.760K     | 804.86KB     |
|    relu_1                      |                      |              | 100.352K     | 802.82KB     |
|    conv3                       | 65.536K              | 51.380M      | 102.760M     | 2.27MB       |
|    bn3                         | 1.024K               |              | 2.007M       | 3.22MB       |
|    relu_2                      |                      |              | 401.408K     | 3.21MB       |
|  add_3                         |                      |              | 401.408K     | 4.82MB       |
|  add_4                         |                      |              | 401.408K     | 4.82MB       |
|  add_5                         |                      |              | 401.408K     | 4.82MB       |
|  add_6                         |                      |              | 401.408K     | 4.82MB       |
|  layer3                        | 7.098M               | 1.464G       | 2.941G       | 80.26MB      |
|   layer3.0                     | 1.512M               | 372.507M     | 748.726M     | 21.73MB      |
|    conv1                       | 131.072K             | 102.760M     | 205.521M     | 2.93MB       |
|    bn1                         | 512                  |              | 1.004M       | 1.61MB       |
|    relu                        |                      |              | 200.704K     | 1.61MB       |
|    conv2                       | 589.824K             | 115.606M     | 231.211M     | 3.36MB       |
|    bn2                         | 512                  |              | 250.880K     | 405.50KB     |
|    relu_1                      |                      |              | 50.176K      | 401.41KB     |
|    conv3                       | 262.144K             | 51.380M      | 102.760M     | 2.05MB       |
|    bn3                         | 2.048K               |              | 1.004M       | 1.62MB       |
|    downsample                  | 526.336K             | 102.760M     | 206.524M     | 6.13MB       |
|     downsample.0               | 524.288K             | 102.760M     | 205.521M     | 4.51MB       |
|     downsample.1               | 2.048K               |              | 1.004M       | 1.62MB       |
|    relu_2                      |                      |              | 200.704K     | 1.61MB       |
|   layer3.1                     | 1.117M               | 218.366M     | 438.538M     | 11.71MB      |
|    conv1                       | 262.144K             | 51.380M      | 102.760M     | 2.05MB       |
|    bn1                         | 512                  |              | 250.880K     | 405.50KB     |
|    relu                        |                      |              | 50.176K      | 401.41KB     |
|    conv2                       | 589.824K             | 115.606M     | 231.211M     | 2.76MB       |
|    bn2                         | 512                  |              | 250.880K     | 405.50KB     |
|    relu_1                      |                      |              | 50.176K      | 401.41KB     |
|    conv3                       | 262.144K             | 51.380M      | 102.760M     | 2.05MB       |
|    bn3                         | 2.048K               |              | 1.004M       | 1.62MB       |
|    relu_2                      |                      |              | 200.704K     | 1.61MB       |
|   layer3.2                     | 1.117M               | 218.366M     | 438.538M     | 11.71MB      |
|    conv1                       | 262.144K             | 51.380M      | 102.760M     | 2.05MB       |
|    bn1                         | 512                  |              | 250.880K     | 405.50KB     |
|    relu                        |                      |              | 50.176K      | 401.41KB     |
|    conv2                       | 589.824K             | 115.606M     | 231.211M     | 2.76MB       |
|    bn2                         | 512                  |              | 250.880K     | 405.50KB     |
|    relu_1                      |                      |              | 50.176K      | 401.41KB     |
|    conv3                       | 262.144K             | 51.380M      | 102.760M     | 2.05MB       |
|    bn3                         | 2.048K               |              | 1.004M       | 1.62MB       |
|    relu_2                      |                      |              | 200.704K     | 1.61MB       |
|   layer3.3                     | 1.117M               | 218.366M     | 438.538M     | 11.71MB      |
|    conv1                       | 262.144K             | 51.380M      | 102.760M     | 2.05MB       |
|    bn1                         | 512                  |              | 250.880K     | 405.50KB     |
|    relu                        |                      |              | 50.176K      | 401.41KB     |
|    conv2                       | 589.824K             | 115.606M     | 231.211M     | 2.76MB       |
|    bn2                         | 512                  |              | 250.880K     | 405.50KB     |
|    relu_1                      |                      |              | 50.176K      | 401.41KB     |
|    conv3                       | 262.144K             | 51.380M      | 102.760M     | 2.05MB       |
|    bn3                         | 2.048K               |              | 1.004M       | 1.62MB       |
|    relu_2                      |                      |              | 200.704K     | 1.61MB       |
|   layer3.4                     | 1.117M               | 218.366M     | 438.538M     | 11.71MB      |
|    conv1                       | 262.144K             | 51.380M      | 102.760M     | 2.05MB       |
|    bn1                         | 512                  |              | 250.880K     | 405.50KB     |
|    relu                        |                      |              | 50.176K      | 401.41KB     |
|    conv2                       | 589.824K             | 115.606M     | 231.211M     | 2.76MB       |
|    bn2                         | 512                  |              | 250.880K     | 405.50KB     |
|    relu_1                      |                      |              | 50.176K      | 401.41KB     |
|    conv3                       | 262.144K             | 51.380M      | 102.760M     | 2.05MB       |
|    bn3                         | 2.048K               |              | 1.004M       | 1.62MB       |
|    relu_2                      |                      |              | 200.704K     | 1.61MB       |
|   layer3.5                     | 1.117M               | 218.366M     | 438.538M     | 11.71MB      |
|    conv1                       | 262.144K             | 51.380M      | 102.760M     | 2.05MB       |
|    bn1                         | 512                  |              | 250.880K     | 405.50KB     |
|    relu                        |                      |              | 50.176K      | 401.41KB     |
|    conv2                       | 589.824K             | 115.606M     | 231.211M     | 2.76MB       |
|    bn2                         | 512                  |              | 250.880K     | 405.50KB     |
|    relu_1                      |                      |              | 50.176K      | 401.41KB     |
|    conv3                       | 262.144K             | 51.380M      | 102.760M     | 2.05MB       |
|    bn3                         | 2.048K               |              | 1.004M       | 1.62MB       |
|    relu_2                      |                      |              | 200.704K     | 1.61MB       |
|  add_7                         |                      |              | 200.704K     | 2.41MB       |
|  add_8                         |                      |              | 200.704K     | 2.41MB       |
|  add_9                         |                      |              | 200.704K     | 2.41MB       |
|  add_10                        |                      |              | 200.704K     | 2.41MB       |
|  add_11                        |                      |              | 200.704K     | 2.41MB       |
|  add_12                        |                      |              | 200.704K     | 2.41MB       |
|  layer4                        | 14.965M              | 809.239M     | 1.622G       | 75.00MB      |
|   layer4.0                     | 6.040M               | 372.507M     | 746.870M     | 32.03MB      |
|    conv1                       | 524.288K             | 102.760M     | 205.521M     | 3.30MB       |
|    bn1                         | 1.024K               |              | 501.760K     | 811.01KB     |
|    relu                        |                      |              | 100.352K     | 802.82KB     |
|    conv2                       | 2.359M               | 115.606M     | 231.211M     | 9.94MB       |
|    bn2                         | 1.024K               |              | 125.440K     | 208.90KB     |
|    relu_1                      |                      |              | 25.088K      | 200.70KB     |
|    conv3                       | 1.049M               | 51.380M      | 102.760M     | 4.70MB       |
|    bn3                         | 4.096K               |              | 501.760K     | 835.58KB     |
|    downsample                  | 2.101M               | 102.760M     | 206.023M     | 10.43MB      |
|     downsample.0               | 2.097M               | 102.760M     | 205.521M     | 9.59MB       |
|     downsample.1               | 4.096K               |              | 501.760K     | 835.58KB     |
|    relu_2                      |                      |              | 100.352K     | 802.82KB     |
|   layer4.1                     | 4.463M               | 218.366M     | 437.635M     | 21.49MB      |
|    conv1                       | 1.049M               | 51.380M      | 102.760M     | 4.70MB       |
|    bn1                         | 1.024K               |              | 125.440K     | 208.90KB     |
|    relu                        |                      |              | 25.088K      | 200.70KB     |
|    conv2                       | 2.359M               | 115.606M     | 231.211M     | 9.64MB       |
|    bn2                         | 1.024K               |              | 125.440K     | 208.90KB     |
|    relu_1                      |                      |              | 25.088K      | 200.70KB     |
|    conv3                       | 1.049M               | 51.380M      | 102.760M     | 4.70MB       |
|    bn3                         | 4.096K               |              | 501.760K     | 835.58KB     |
|    relu_2                      |                      |              | 100.352K     | 802.82KB     |
|   layer4.2                     | 4.463M               | 218.366M     | 437.635M     | 21.49MB      |
|    conv1                       | 1.049M               | 51.380M      | 102.760M     | 4.70MB       |
|    bn1                         | 1.024K               |              | 125.440K     | 208.90KB     |
|    relu                        |                      |              | 25.088K      | 200.70KB     |
|    conv2                       | 2.359M               | 115.606M     | 231.211M     | 9.64MB       |
|    bn2                         | 1.024K               |              | 125.440K     | 208.90KB     |
|    relu_1                      |                      |              | 25.088K      | 200.70KB     |
|    conv3                       | 1.049M               | 51.380M      | 102.760M     | 4.70MB       |
|    bn3                         | 4.096K               |              | 501.760K     | 835.58KB     |
|    relu_2                      |                      |              | 100.352K     | 802.82KB     |
|  add_13                        |                      |              | 100.352K     | 1.20MB       |
|  add_14                        |                      |              | 100.352K     | 1.20MB       |
|  add_15                        |                      |              | 100.352K     | 1.20MB       |
|  avgpool                       |                      |              |              | 409.60KB     |
|  fc                            | 2.049M               | 2.048M       | 4.096M       | 8.21MB       |

Compute Metrics:
  - Conv2d/Linear: MACs (multiply-accumulate operations)
  - BatchNorm: 5 FLOPs/element (normalize + scale + shift)
  - ReLU: 1 FLOP/element (max(0,x) comparison)
  - Add/Mul/Sub/Div: 1 FLOP/element (elementwise operation)
  - MaxPool/AdaptiveAvgPool: 0 FLOPs (comparison-based, matches fvcore)

Shape Information (shown with --showshape):
  - Parameters: Learnable weights/biases (e.g., conv.weight shape)
  - Tensor Shape: Output tensor dimensions during forward pass (e.g., [1, 64, 56, 56])
  - Operations without parameters (ReLU, MaxPool) only show Tensor Shape

====================================================================================================
SUMMARY
====================================================================================================

Total parameters: 25.56M (25,557,032)
Total FLOPs: 8.249 GFLOPs (8,249,066,496)
Total MACs: 4.089 GMACs (4,089,184,256)
Total memory: 426.00 MB (425,995,840 bytes)

Subgraphs: 174
Average AI: 17.83 FLOPs/byte
